<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cyber Buddy Academy Bill Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #e9eef5; padding: 40px; }
    .container { background: #fff; border-radius: 12px; padding: 30px; max-width: 600px; margin: auto;
                 box-shadow: 0 0 15px rgba(0,0,0,0.1); }
    h1 { color: #0056b3; text-align: center; margin-bottom: 30px; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; margin-top: 5px; }
    button { background: #0056b3; color: white; border: none; padding: 12px 20px; margin-top: 20px;
             border-radius: 5px; cursor: pointer; width: 100%; font-size: 16px; }
    button:hover { background: #003f88; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Cyber Buddy Academy - Bill Generator</h1>
    <label>Name:</label><input id="name">
    <label>Course:</label><input id="course">
    <label>Amount (INR):</label><input id="amount" type="number">
    <label>Payment ID:</label><input id="paymentId">
    <button onclick="generateBill()">Generate Bill</button>
  </div>

  <script>
    async function generateBill() {
      const name = document.getElementById('name').value.trim();
      const course = document.getElementById('course').value.trim();
      const amount = document.getElementById('amount').value.trim();
      const paymentId = document.getElementById('paymentId').value.trim();

      if (!name || !course || !amount || !paymentId) {
        alert("Please fill all fields!");
        return;
      }

      const date = new Date().toLocaleDateString();
      const billId = "CBA-" + Date.now();
      const verifyUrl = `https://mubyyy404.github.io/Cyber-Buddy/verifybill.html?billid=${billId}`;
      const bill = { billId, name, course, amount, date, paymentId, verifyUrl };

      // === Generate PDF ===
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF();
      pdf.setFontSize(18);
      pdf.text("Cyber Buddy Academy", 65, 20);
      pdf.setFontSize(12);
      pdf.text(`Bill ID: ${billId}`, 20, 40);
      pdf.text(`Name: ${name}`, 20, 50);
      pdf.text(`Course: ${course}`, 20, 60);
      pdf.text(`Amount: ₹${amount}`, 20, 70);
      pdf.text(`Payment ID: ${paymentId}`, 20, 80);
      pdf.text(`Date: ${date}`, 20, 90);
      pdf.text("Thank you for learning with Cyber Buddy Academy!", 20, 120);

      const qr = new QRious({ value: verifyUrl, size: 100 });
      pdf.addImage(qr.toDataURL(), "PNG", 150, 30, 40, 40);
      pdf.save(`${billId}.pdf`);

      alert("✅ Bill PDF generated.\n\nNote: Upload manually to bills.json (server update restricted in front-end).");

      // --- Optional: log data locally for testing ---
      console.log("Bill Data:", bill);
    }
  </script>
</body>
</html>
